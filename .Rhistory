x2009$Muprep <- x2009$muprep
x2009$PuebloPP <- x2009$Gretnp
x2009$Paisnacp <- 9999
x2009$Escolap <- 9
x2009$Paisrem <- 9999
x2009$PuebloPM <- x2009$Gretnm
x2009$Paisnacm <- 9999
x2009$Escolam <- 9
x2009$Añoocu <- 2009
#Arreglos del dataset 2010
x2010$Añoocu <- 2010
x2010$Mupreg <- x2010$mupreg
x2010$TipoIns <- 0
x2010$ViaPar <-0
x2010$Paisrep <-9999
x2010$Muprep <- x2010$muprep
x2010$PuebloPP <- x2010$Gretnp
x2010$Paisnacp <- 9999
x2010$Mupnap <- x2010$mupnap
x2010$Paisrem <- 9999
x2010$Mupnam <- x2010$mupnam
x2010$Muprem <- x2010$muprem
x2010$PuebloPM <- x2010$grupetma
x2010$Paisnacm <- 9999
#Arreglo de 2011
x2011$Añoocu <- 2011
x2011$TipoIns <- 0
x2011$ViaPar <-0
x2011$PuebloPP <- x2011$Gretnp
x2011$Paisnacp <- 9999
x2011$Paisrem <- 9999
x2011$PuebloPM <- x2011$grupetma
x2011$Paisnacm <- 9999
x2011$Paisrep <-9999
x2011$Mupnap <- 9999
x2011$Mupnam <- 9999
#Arreglo 2012
x2012$TipoIns <- 0
x2012$ViaPar <-0
x2012$Areag <- 9
x2012$PuebloPP <- x2012$Gretnp
x2012$PuebloPM <- x2012$grupetma
x2012$Mupnam <- x2012$munnam
x2012$Añoocu <- 2012
#Arreglo 2013
x2013$TipoIns <- 0
x2013$ViaPar <-0
x2013$Areag <- 9
x2013$Ocupap <- x2013$Ciuopad
x2013$Ocupam <- x2013$Ciuomad
x2013$Añoocu <- 2013
#Arreglo 2014
x2014$TipoIns <- 0
x2014$ViaPar <-0
x2014$Areag <- 9
x2014$Mupnap <- x2014$Munpnap
x2014$Naciop <- 9999
x2014$Naciom <- 9999
x2014$Añoocu <- 2014
x2014$Ocupam <- x2014$ciuomad
x2014$Añoocu <- 2014
#Arreglo 2015
x2015$Areag <- 9
x2015$Naciop <- 9999
x2015$Naciom <- 9999
x2015$Mupnap <- x2015$Munpnap
x2015$Añoocu <- 2015
#Arreglo 2016
x2016$Areag <- 9
x2016$Naciop <- 9999
x2016$Naciom <- 9999
x2016$Mupnap <- x2016$Munpnap
x2016$Añoocu <- 2016
#Arreglo 2017
x2017$Areag <- 9
x2017$Naciop <- 9999
x2017$Naciom <- 9999
x2017$Mupnap <- x2017$Munpnap
x2017$Añoocu <- 2017
#Arreglo 2018
x2018$Areag <- 9
x2018$Naciop <- 9999
x2018$Naciom <- 9999
x2018$Mupnap <- x2018$Munpnap
x2018$Añoocu <- 2018
#Arreglo 2019
x2019$Areag <- 9
x2019$Naciop <- 9999
x2019$Naciom <- 9999
x2019$Mupnap <- x2019$Munpnap
x2019$Añoocu <- 2019
datosx2009 <- (x2009 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2010 <- (x2010 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2011 <- (x2011 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2012 <- (x2012 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2013 <- (x2013 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2014 <- (x2014 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2015 <- (x2015 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2016 <- (x2016 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2017 <- (x2017 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2018 <- (x2018 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2019 <- (x2019 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
totx2009 <- datosx2009 %>%
mutate_if(is.labelled, list(as_factor))
totx2010 <- datosx2010 %>%
mutate_if(is.labelled, list(as_factor))
totx2011 <- datosx2011 %>%
mutate_if(is.labelled, list(as_factor))
totx2012 <- datosx2012 %>%
mutate_if(is.labelled, list(as_factor))
totx2013 <- datosx2013 %>%
mutate_if(is.labelled, list(as_factor))
totx2014 <- datosx2014 %>%
mutate_if(is.labelled, list(as_factor))
totx2015 <- datosx2015 %>%
mutate_if(is.labelled, list(as_factor))
totx2016 <- datosx2016 %>%
mutate_if(is.labelled, list(as_factor))
totx2017 <- datosx2017 %>%
mutate_if(is.labelled, list(as_factor))
totx2018 <- datosx2018 %>%
mutate_if(is.labelled, list(as_factor))
totx2019 <- datosx2019 %>%
mutate_if(is.labelled, list(as_factor))
datos<-datosx2009
datos2009completos<-datosx2009[complete.cases(datosx2009),]
km<-kmeans(datosx2009[,c(5,9,10,13,17,29,43,44,45)],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadm))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadm))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Edadm))*100
plotcluster(datosx2009[,c(5,9,10,13,17,29,43,44,45)],km$cluster) #grafica la ubicaciÃ³n de los clusters
datos<-datosx2010
datos2010completos<-datosx2010[complete.cases(datosx2010),]
km<-kmeans(datosx2010[,c(5,9,10,13,17,29,43,44,45)],2,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadm))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadm))*100
plotcluster(datosx2010[,c(5,9,10,13,17,29,43,44,45)],km$cluster) #grafica la ubicaciÃ³n de los clusters
datos<-datosx2010
datos2010completos<-datosx2010[complete.cases(datosx2010),]
km<-kmeans(datosx2010[,c(5,9,10,13,17,29,43,44,45)],2,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadp))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadp))*100
plotcluster(datosx2010[,c(5,9,10,13,17,29,43,44,45)],km$cluster) #grafica la ubicaciÃ³n de los clusters
fviz_cluster(km, data = iris[,1:4],geom = "point", ellipse.type = "norm")
datos<-iris
irisCompleto<-iris[complete.cases(iris),]
km<-kmeans(iris[,1:4],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Species))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Species))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Species))*100
plotcluster(iris[,1:4],km$cluster) #grafica la ubicaciÃ³n de los cluster
datos<-iris
irisCompleto<-iris[complete.cases(iris),]
km<-kmeans(iris[,1:4],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Species))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Species))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Species))*100
plotcluster(iris[,1:4],km$cluster) #grafica la ubicaciÃ³n de los cluster
plotcluster(iris[,1:4],km$cluster) #grafica la ubicaciÃ³n de los clusters
plotcluster(iris[,1:4],km$cluster) #grafica la ubicaciÃ³n de los clusters
fviz_cluster(km, data = iris[,1:4],geom = "point", ellipse.type = "norm")
datos<-datosx2009
datos2009completos<-datosx2009[complete.cases(datosx2009),]
km<-kmeans(datosx2009[,c(5,9,10,13,17,29,43,44,45)],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadm))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadm))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Edadm))*100
plotcluster(datosx2009[,c(5,9,10,13,17,29,43,44,45)],km$cluster) #grafica la ubicaciÃ³n de los clusters
fviz_cluster(km, data = datosx2009[,c(5,9,10,13,17,29,43,44,45)],geom = "point", ellipse.type = "norm")
fviz_cluster(km, data = datosx2009[,c(5,9,10,13,17,29,43,44,45)],geom = "point", ellipse.type = "norm")
datos<-datosx2009
datos2009completos<-datosx2009[complete.cases(datosx2009),]
km<-kmeans(datosx2009[,c(5,9,10,13,17,29,43,44,45)],3,iter.max =100)
datos$grupo<-km$cluster
plot(1:10, wss, type="b", xlab="Number of Clusters (2019)",  ylab="Within groups sum of squares")
plot(1:10, wss, type="b", xlab="Number of Clusters (2019)",  ylab="Within groups sum of squares")
fviz_cluster(km, data = datosx2009[,c(5,9,10,13,17,29,43,44,45)],geom = "point", ellipse.type = "norm")
datos<-datosx2009
datos2009completos<-datosx2009[complete.cases(datosx2009),]
km<-kmeans(datosx2009[,c(5,9,10,13,17,29,43,44,45)],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadm))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadm))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Edadm))*100
fviz_cluster(km, data = datosx2009[,c(5,9,10,13,17,29,43,44,45)],geom = "point", ellipse.type = "norm")
silkm<-silhouette(km$cluster,dist(datosx2009[,c(5,9,10,13,17,29,43,44,45)]))
memory.limit(size=2500)
#Silueta 2009
memory.limit(size=9999999999999999999)
#Silueta 2009
memory.limit(size=999999999999999999999999999999999999999)
#Silueta 2009
memory.limit(99999999999999999999999999999999)
memory.limit()
memory.limit()
prop.table(table(g1$Edadm))*100
memory.limit(9000)
memory.limit()
#Silueta 2009
memory.limit(99999999999999)
#Silueta 2009
memory.limit(99999999999)
memory.limit(99999999999)
memory.limit(999999999999)
memory.limit(9999999999999)
memory.limit(99999999999999)
#Silueta 2009
memory.limit()
silkm<-silhouette(km$cluster,dist(datosx2009[,c(5,9,10,13,17,29,43,44,45)]))
mean(silkm[,3])
silkm<-silhouette(km$cluster,dist(iris[,1:4]))
mean(silkm[,3])
silkm<-silhouette(km$cluster,dist(iris[,1:4]))
datos<-iris
irisCompleto<-iris[complete.cases(iris),]
km<-kmeans(iris[,1:4],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Species))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Species))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Species))*100
plotcluster(iris[,1:4],km$cluster) #grafica
Clustering jerÃ¡rquico
hc<-hclust(dist(iris[,1:4])) #Genera el clustering jerÃ¡rquico de los datos
plot(hc) #Genera el dendograma
rect.hclust(hc,k=3) #Dibuja el corte de los grupos en el grÃ¡fico
groups<-cutree(hc,k=3) #corta el dendograma, determinando el grupo de cada fila
datos$gruposHC<-groups
g1HC<-datos[datos$gruposHC==1,]
g2HC<-datos[datos$gruposHC==2,]
g3HC<-datos[datos$gruposHC==3,]
#Fuzzy C-Means
fcm<-cmeans(iris[,1:4],3)
datos$FCGrupos<-fcm$cluster
datos<-cbind(datos,fcm$membership)
library(cluster) #Para calcular la silueta
library(e1071)#para cmeans
library(mclust) #mixtures of gaussians
library(fpc) #para hacer el plotcluster
library(NbClust) #Para determinar el número de clusters óptimo
library(factoextra) #Para hacer gráficos bonitos de clustering
Clustering jerÃ¡rquico
hc<-hclust(dist(iris[,1:4])) #Genera el clustering jerÃ¡rquico de los datos
plot(hc) #Genera el dendograma
rect.hclust(hc,k=3) #Dibuja el corte de los grupos en el grÃ¡fico
groups<-cutree(hc,k=3) #corta el dendograma, determinando el grupo de cada fila
datos$gruposHC<-groups
g1HC<-datos[datos$gruposHC==1,]
g2HC<-datos[datos$gruposHC==2,]
g3HC<-datos[datos$gruposHC==3,]
#Fuzzy C-Means
fcm<-cmeans(iris[,1:4],3)
datos$FCGrupos<-fcm$cluster
datos<-cbind(datos,fcm$membership)
#Mixture of gaussians
mc<-Mclust(iris[,1:4],3)
plot(mc, what = "classification", main="MClust Classification")
datos$mxGau<-mc$classification
g1MC<-datos[datos$mxGau==1,]
g2MC<-datos[datos$mxGau==2,]
g3MC<-datos[datos$mxGau==3,]
#MÃ©todo de la silueta para las k-medias
silkm<-silhouette(km$cluster,dist(iris[,1:4]))
mean(silkm[,3]) #0.55, no es la mejor particiÃ³n pero no estÃ¡ mal
library(e1071)
library(mclust)
silkm<-silhouette(km$cluster,dist(datosx2009[,c(5,9,10,13,17,29,43,44,45)]))
sil <- silhouette(clustering$cluster, dist(input))
fviz_silhouette(sil)
sil <- silhouette(clustering$cluster, dist(input))
sil <- silhouette(datos$grupo, dist(2))
silhouette(datosx2009)
silhouette(datosx2009[,c(5,9,10,13,17,29,43,44,45)],3,iter.max =100)
silhouette(datosx2009[,c(5,9,10,13,17,29,43,44,45)])
#Silueta 2009
silhouette(datosx2009)
silhouette(datosx2009[,c(5,9,10,13,17,29,43,44,45)
silhouette(datosx2009[,c(5,9,10,13,17,29,43,44,45)
silhouette(datosx2009[,c(5,9,10,13,17,29,43,44,45)
silueta2009<-silhouette(datosx2009[,c(5,9,10,13,17,29,43,44,45)
mean(silueta2009[,3])
silueta2009<-silhouette(datosx2009[,c(5,9,10,13,17,29,43,44,45)
mean(silueta2009[,3])
silhouette2009 <- datosx2019[,c(5,9,10,13,17,29,43,44,45))
silhouette2009 <- datosx2019[,c(5,9,10,13,17,29,43,44,45) ]
silhouette(silhouette2009)
silhouette2009 <- (nrow(datosx2019[,c(5,9,10,13,17,29,43,44,45))) ]
silhouette2009 <- (nrow(datosx2019[,c(5,9,10,13,17,29,43,44,45) ]))
silhouette(silhouette2009)
silhouette(silhouette2009)
silhouette(silhouette2009)
silhouette2009 <- (nrow(datosx2019[,c(5,9,10,13,17,29,43,44,45) ]))
silhouette2009 <- (nrow(datosx2019[,c(5,9,10,13,17,29,43,44,45) ]))
silhouette(silhouette2009)
datos<-datosx2019
datos2019completos<-datosx2019[complete.cases(datosx2019),]
km<-kmeans(datosx2019[,c(5,9,10,13,17,29,43,44,45)],2,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadm))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadm))*100
silhouette2019 <- (nrow(datosx2019[,c(5,9,10,13,17,29,43,44,45) ]))
km<-kmeans(datosx2019[,c(5,9,10,13,17,29,43,44,45)],2,iter.max =100)
silhouette2019 <- datos2019completos[,c(5,9,10,13,17,29,43,44,45) ]
silhouette(silhouette2019)
km<-kmeans(datosx2019[,c(5,9,10,13,17,29,43,44,45)],2,iter.max =100)
silhouette(km)
silhouette(datos$grupo)
silhouette2019 <- (nrow(datos2019completos[,c(5,9,10,13,17,29,43,44,45) ]))
silhouette(silhouette2019)
silhouette(silhouette2019)
silhouette2019 <- (nrow(datos2019completos[,c(5,9,10,13,17,29,43,44,45) ]))
silhouette(silhouette2019)
library(haven)
library(dplyr)
library(tidyverse)
library(NbClust) #Para determinar el número de clusters óptimo
library(factoextra) #Para hacer gráficos bonitos de clustering
library(fpc) #para hacer el plotcluster
library(cluster) #Para calcular la silueta
library(e1071)
library(mclust)
setwd("C:/Users/LUIS PEDRO/proyecto1")
x2009 <- read_sav("2009.sav")
x2010 <- read_sav("2010.sav")
x2011 <- read_sav("2011.sav")
x2012 <- read_sav("2012.sav")
x2013 <- read_sav("2013.sav")
x2014 <- read_sav("2014.sav")
x2015 <- read_sav("2015.sav")
x2016 <- read_sav("2016.sav")
x2017 <- read_sav("2017.sav")
x2018 <- read_sav("2018.sav")
x2019 <- read_sav("2019.sav")
#Arreglo del dataset de 2009
x2009$Mupreg <- x2009$mupreg
x2009$TipoIns <- 0
x2009$ViaPar <-0
x2009$Paisrep <-9999
x2009$Muprep <- x2009$muprep
x2009$PuebloPP <- x2009$Gretnp
x2009$Paisnacp <- 9999
x2009$Escolap <- 9
x2009$Paisrem <- 9999
x2009$PuebloPM <- x2009$Gretnm
x2009$Paisnacm <- 9999
x2009$Escolam <- 9
x2009$Añoocu <- 2009
#Arreglos del dataset 2010
x2010$Añoocu <- 2010
x2010$Mupreg <- x2010$mupreg
x2010$TipoIns <- 0
x2010$ViaPar <-0
x2010$Paisrep <-9999
x2010$Muprep <- x2010$muprep
x2010$PuebloPP <- x2010$Gretnp
x2010$Paisnacp <- 9999
x2010$Mupnap <- x2010$mupnap
x2010$Paisrem <- 9999
x2010$Mupnam <- x2010$mupnam
x2010$Muprem <- x2010$muprem
x2010$PuebloPM <- x2010$grupetma
x2010$Paisnacm <- 9999
#Arreglo de 2011
x2011$Añoocu <- 2011
x2011$TipoIns <- 0
x2011$ViaPar <-0
x2011$PuebloPP <- x2011$Gretnp
x2011$Paisnacp <- 9999
x2011$Paisrem <- 9999
x2011$PuebloPM <- x2011$grupetma
x2011$Paisnacm <- 9999
x2011$Paisrep <-9999
x2011$Mupnap <- 9999
x2011$Mupnam <- 9999
#Arreglo 2012
x2012$TipoIns <- 0
x2012$ViaPar <-0
x2012$Areag <- 9
x2012$PuebloPP <- x2012$Gretnp
x2012$PuebloPM <- x2012$grupetma
x2012$Mupnam <- x2012$munnam
x2012$Añoocu <- 2012
#Arreglo 2013
x2013$TipoIns <- 0
x2013$ViaPar <-0
x2013$Areag <- 9
x2013$Ocupap <- x2013$Ciuopad
x2013$Ocupam <- x2013$Ciuomad
x2013$Añoocu <- 2013
#Arreglo 2014
x2014$TipoIns <- 0
x2014$ViaPar <-0
x2014$Areag <- 9
x2014$Mupnap <- x2014$Munpnap
x2014$Naciop <- 9999
x2014$Naciom <- 9999
x2014$Añoocu <- 2014
x2014$Ocupam <- x2014$ciuomad
x2014$Añoocu <- 2014
#Arreglo 2015
x2015$Areag <- 9
x2015$Naciop <- 9999
x2015$Naciom <- 9999
x2015$Mupnap <- x2015$Munpnap
x2015$Añoocu <- 2015
#Arreglo 2016
x2016$Areag <- 9
x2016$Naciop <- 9999
x2016$Naciom <- 9999
x2016$Mupnap <- x2016$Munpnap
x2016$Añoocu <- 2016
#Arreglo 2017
x2017$Areag <- 9
x2017$Naciop <- 9999
x2017$Naciom <- 9999
x2017$Mupnap <- x2017$Munpnap
x2017$Añoocu <- 2017
#Arreglo 2018
x2018$Areag <- 9
x2018$Naciop <- 9999
x2018$Naciom <- 9999
x2018$Mupnap <- x2018$Munpnap
x2018$Añoocu <- 2018
#Arreglo 2019
x2019$Areag <- 9
x2019$Naciop <- 9999
x2019$Naciom <- 9999
x2019$Mupnap <- x2019$Munpnap
x2019$Añoocu <- 2019
datosx2009 <- (x2009 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2010 <- (x2010 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2011 <- (x2011 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2012 <- (x2012 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2013 <- (x2013 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2014 <- (x2014 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2015 <- (x2015 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2016 <- (x2016 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2017 <- (x2017 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2018 <- (x2018 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datosx2019 <- (x2019 %>% select(Depreg, Mupreg, Mesreg, TipoIns, Añoreg, Depocu,Mupocu,Areag,Libras, Onzas, Diaocu, Mesocu, Añoocu, Sexo, Tipar, ViaPar, Edadp, Paisrep,Deprep,Muprep, PuebloPP, Escivp,Paisnacp,Depnap,Mupnap, Naciop, Escolap, Ocupap, Edadm, Paisrem, Deprem, Muprem, PuebloPM, Escivm, Paisnacm, Depnam,Mupnam,Naciom, Escolam, Ocupam, Asisrec, Sitioocu, Tohite, Tohinm, Tohivi))
datos<-datosx2009
datos2009completos<-datosx2009[complete.cases(datosx2009),]
km<-kmeans(datosx2009[,c(5,9,10,13,17,29,43,44,45)],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadm))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadm))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Edadm))*100
datos<-datosx2009
datos2009completos<-datosx2009[complete.cases(datosx2009),]
km<-kmeans(datosx2009[,c(5,9,10,13,17,29,43,44,45)],3,iter.max =100)
datos$grupo<-km$cluster
g1<- datos[datos$grupo==1,]
prop.table(table(g1$Edadp))*100
nrow(g1)
summary(g1)
g2<- datos[datos$grupo==2,]
prop.table(table(g2$Edadp))*100
g3<- datos[datos$grupo==3,]
prop.table(table(g3$Edadp))*100
plotcluster(datosx2009[,c(5,9,10,13,17,29,43,44,45)],km$cluster) #grafica la ubicaciÃ³n de los clusters
